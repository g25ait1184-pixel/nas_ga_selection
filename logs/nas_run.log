Using device: cuda
Starting with 3 Population:
[Arch(conv=1, acc=0.0000, fit=0.0000), Arch(conv=2, acc=0.0000, fit=0.0000), Arch(conv=1, acc=0.0000, fit=0.0000)]


============================================================
Generation 1/3
============================================================
Evaluating architecture 1/3... Conv params: 4800, FC params: 1049994
Total params: 1054794
Accuracy: 0.562000
Original fitness: 0.551452
Weighted fitness: 0.561995
Fitness (orig): 0.5515, Accuracy: 0.5620
Weighted fitness: 0.5620
Evaluating architecture 2/3... Conv params: 107584, FC params: 2098570
Total params: 2206154
Accuracy: 0.594000
Original fitness: 0.571938
Weighted fitness: 0.593989
Fitness (orig): 0.5719, Accuracy: 0.5940
Weighted fitness: 0.5940
Evaluating architecture 3/3... Conv params: 9984, FC params: 2097866
Total params: 2107850
Accuracy: 0.462000
Original fitness: 0.440922
Weighted fitness: 0.461990
Fitness (orig): 0.4409, Accuracy: 0.4620
Weighted fitness: 0.4620

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=2, acc=0.5940, fit=0.5719)

Best overall: Arch(conv=2, acc=0.5940, fit=0.5719)

Performing selection (method=tournament) of total population: 3 ...
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=2, acc=0.5940, fit=0.5719), Arch(conv=1, acc=0.5620, fit=0.5515), Arch(conv=2, acc=0.0000, fit=0.0000)]

============================================================
Generation 2/3
============================================================
Evaluating architecture 1/3... Conv params: 107584, FC params: 2098570
Total params: 2206154
Accuracy: 0.596000
Original fitness: 0.573938
Weighted fitness: 0.595989
Fitness (orig): 0.5739, Accuracy: 0.5960
Weighted fitness: 0.5960
Evaluating architecture 2/3... Conv params: 4800, FC params: 1049994
Total params: 1054794
Accuracy: 0.559000
Original fitness: 0.548452
Weighted fitness: 0.558995
Fitness (orig): 0.5485, Accuracy: 0.5590
Weighted fitness: 0.5590
Evaluating architecture 3/3... Conv params: 107584, FC params: 2098570
Total params: 2206154
Accuracy: 0.587000
Original fitness: 0.564938
Weighted fitness: 0.586989
Fitness (orig): 0.5649, Accuracy: 0.5870
Weighted fitness: 0.5870

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=2, acc=0.5960, fit=0.5739)

Best overall: Arch(conv=2, acc=0.5960, fit=0.5739)

Performing selection (method=tournament) of total population: 3 ...
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=2, acc=0.5960, fit=0.5739), Arch(conv=2, acc=0.5870, fit=0.5649), Arch(conv=2, acc=0.0000, fit=0.0000)]

============================================================
Generation 3/3
============================================================
Evaluating architecture 1/3... Conv params: 107584, FC params: 2098570
Total params: 2206154
Accuracy: 0.570000
Original fitness: 0.547938
Weighted fitness: 0.569989
Fitness (orig): 0.5479, Accuracy: 0.5700
Weighted fitness: 0.5700
Evaluating architecture 2/3... Conv params: 107584, FC params: 2098570
Total params: 2206154
Accuracy: 0.605000
Original fitness: 0.582938
Weighted fitness: 0.604989
Fitness (orig): 0.5829, Accuracy: 0.6050
Weighted fitness: 0.6050
Evaluating architecture 3/3... Conv params: 107584, FC params: 2098570
Total params: 2206154
Accuracy: 0.583000
Original fitness: 0.560938
Weighted fitness: 0.582989
Fitness (orig): 0.5609, Accuracy: 0.5830
Weighted fitness: 0.5830

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=2, acc=0.6050, fit=0.5829)

Best overall: Arch(conv=2, acc=0.6050, fit=0.5829)

Performing selection (method=tournament) of total population: 3 ...
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=2, acc=0.6050, fit=0.5829), Arch(conv=2, acc=0.5830, fit=0.5609), Arch(conv=2, acc=0.0000, fit=0.0000)]

============================================================
FINAL BEST ARCHITECTURE
============================================================
Genes: {'num_conv': 2, 'conv_configs': [{'filters': 64, 'kernel_size': 5}, {'filters': 64, 'kernel_size': 5}], 'pool_type': 'avg', 'activation': 'relu', 'fc_units': 128}
Accuracy: 0.6050
Fitness: 0.5829

Total parameters: 2,206,154

Model architecture:
CNN(
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): Linear(in_features=16384, out_features=128, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.5, inplace=False)
    (4): Linear(in_features=128, out_features=10, bias=True)
  )
)
Starting with 3 Population:
[Arch(conv=2, acc=0.0000, fit=0.0000), Arch(conv=1, acc=0.0000, fit=0.0000), Arch(conv=4, acc=0.0000, fit=0.0000)]


============================================================
Generation 1/3
============================================================
Evaluating architecture 1/3... Conv params: 14112, FC params: 2099978
Total params: 2114090
Accuracy: 0.553000
Original fitness: 0.531859
Weighted fitness: 0.552989
Fitness (orig): 0.5319, Accuracy: 0.5530
Weighted fitness: 0.5530
Evaluating architecture 2/3... Conv params: 4992, FC params: 2098570
Total params: 2103562
Accuracy: 0.547000
Original fitness: 0.525964
Weighted fitness: 0.546990
Fitness (orig): 0.5260, Accuracy: 0.5470
Weighted fitness: 0.5470
Evaluating architecture 3/3... Conv params: 156704, FC params: 131786
Total params: 288490
Accuracy: 0.637000
Original fitness: 0.634115
Weighted fitness: 0.636999
Fitness (orig): 0.6341, Accuracy: 0.6370
Weighted fitness: 0.6370

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=4, acc=0.6370, fit=0.6370)

Best overall: Arch(conv=4, acc=0.6370, fit=0.6370)

Performing selection (method=roulette) of total population: 3 ...

 Relative Fitness Scores (normalized):
[0.36672837600550334, 0.3183629447657875, 0.31490867922870924]
Cumulative Selection Probabilities:
[0.36672837600550334, 0.6850913207712909, 1.0]

Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=4, acc=0.6370, fit=0.6370), Arch(conv=2, acc=0.5530, fit=0.5530), Arch(conv=2, acc=0.5530, fit=0.5530)]

============================================================
Generation 2/3
============================================================
Evaluating architecture 1/3... Conv params: 156704, FC params: 131786
Total params: 288490
Accuracy: 0.635000
Original fitness: 0.632115
Weighted fitness: 0.634999
Fitness (orig): 0.6321, Accuracy: 0.6350
Weighted fitness: 0.6350
Evaluating architecture 2/3... Conv params: 14112, FC params: 2099978
Total params: 2114090
Accuracy: 0.568000
Original fitness: 0.546859
Weighted fitness: 0.567989
Fitness (orig): 0.5469, Accuracy: 0.5680
Weighted fitness: 0.5680
Evaluating architecture 3/3... Conv params: 14112, FC params: 2099978
Total params: 2114090
Accuracy: 0.570000
Original fitness: 0.548859
Weighted fitness: 0.569989
Fitness (orig): 0.5489, Accuracy: 0.5700
Weighted fitness: 0.5700

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=4, acc=0.6350, fit=0.6350)

Best overall: Arch(conv=4, acc=0.6370, fit=0.6370)

Performing selection (method=roulette) of total population: 3 ...

 Relative Fitness Scores (normalized):
[0.35815398068353205, 0.32148703239952475, 0.32035898691694314]
Cumulative Selection Probabilities:
[0.35815398068353205, 0.6796410130830568, 1.0]

Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=4, acc=0.6350, fit=0.6350), Arch(conv=2, acc=0.5700, fit=0.5700), Arch(conv=2, acc=0.5680, fit=0.5680)]

============================================================
Generation 3/3
============================================================
Evaluating architecture 1/3... Conv params: 156704, FC params: 131786
Total params: 288490
Accuracy: 0.629000
Original fitness: 0.626115
Weighted fitness: 0.628999
Fitness (orig): 0.6261, Accuracy: 0.6290
Weighted fitness: 0.6290
Evaluating architecture 2/3... Conv params: 14112, FC params: 2099978
Total params: 2114090
Accuracy: 0.575000
Original fitness: 0.553859
Weighted fitness: 0.574989
Fitness (orig): 0.5539, Accuracy: 0.5750
Weighted fitness: 0.5750
Evaluating architecture 3/3... Conv params: 14112, FC params: 2099978
Total params: 2114090
Accuracy: 0.576000
Original fitness: 0.554859
Weighted fitness: 0.575989
Fitness (orig): 0.5549, Accuracy: 0.5760
Weighted fitness: 0.5760

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=4, acc=0.6290, fit=0.6290)

Best overall: Arch(conv=4, acc=0.6370, fit=0.6370)

Performing selection (method=roulette) of total population: 3 ...

 Relative Fitness Scores (normalized):
[0.353374664805762, 0.3235935699206744, 0.32303176527356353]
Cumulative Selection Probabilities:
[0.353374664805762, 0.6769682347264364, 1.0]

Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=4, acc=0.6290, fit=0.6290), Arch(conv=2, acc=0.5760, fit=0.5760), Arch(conv=2, acc=0.0000, fit=0.0000)]

============================================================
FINAL BEST ARCHITECTURE
============================================================
Genes: {'num_conv': 4, 'conv_configs': [{'filters': 128, 'kernel_size': 7}, {'filters': 32, 'kernel_size': 5}, {'filters': 32, 'kernel_size': 5}, {'filters': 32, 'kernel_size': 3}], 'pool_type': 'avg', 'activation': 'leaky_relu', 'fc_units': 64}
Accuracy: 0.6370
Fitness: 0.6370

Total parameters: 288,490

Model architecture:
CNN(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): LeakyReLU(negative_slope=0.1, inplace=True)
    (3): Conv2d(128, 32, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): LeakyReLU(negative_slope=0.1, inplace=True)
    (6): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (7): Conv2d(32, 32, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): LeakyReLU(negative_slope=0.1, inplace=True)
    (10): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (11): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): LeakyReLU(negative_slope=0.1, inplace=True)
    (13): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): Linear(in_features=2048, out_features=64, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.5, inplace=False)
    (4): Linear(in_features=64, out_features=10, bias=True)
  )
)
